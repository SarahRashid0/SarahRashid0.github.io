{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "UK Paracetamol Prices: London, NI, Scotland, Wales",
    "anchor": "start",
    "fontSize": 18,
    "fontWeight": "bold",
    "font": "Baskerville",
    "subtitle": [
      "Average prices over time",
      "Source: Source: ONS microdata via Davies"
    ],
    "subtitleFontSize": 13,
    "subtitleColor": "#666",
    "subtitleFont": "Baskerville"
  },
  "width": 500,
  "height": 300,
  "data": {
    "url": "https://raw.githubusercontent.com/SarahRashid0/SarahRashid0.github.io/refs/heads/main/portfolio_task9/avg_painkiller_price.csv"
  },
  "params": [
    {
      "name": "yearParam",
      "value": 2025,
      "bind": {
        "input": "range",
        "min": 1997,
        "max": 2025,
        "step": 1,
        "name": "Filter to Year:"
      }
    },
    {
      "name": "regionFilter",
      "value": "All",
      "bind": {
        "input": "select",
        "options": ["All", "London", "Northern Ireland", "Scotland", "Wales"],
        "name": "Select Region:"
      }
    },
    {
      "name": "regionSelect",
      "select": {"type": "point", "fields": ["region_name"]},
      "bind": "legend"
    }
  ],
  "transform": [
    {
      "calculate": "year(datum.quote_date)",
      "as": "year"
    },
    {
      "calculate": "toNumber(datum.price)",
      "as": "price_num"
    },
    {
      "filter": "datum.region_name == 'London' || datum.region_name == 'Northern Ireland' || datum.region_name == 'Scotland' || datum.region_name == 'Wales'"
    },
    {
      "filter": "datum.year <= yearParam"
    },
    {
      "filter": "regionFilter == 'All' || datum.region_name == regionFilter"
    },
    {
      "aggregate": [{"op": "mean", "field": "price_num", "as": "avg_price"}],
      "groupby": ["year", "region_name"]
    }
  ],
  "mark": {
    "type": "line",
    "strokeWidth": 2.0,
    "point": {
      "filled": true,
      "size": 25
    },
    "cursor": "pointer"
  },
  "encoding": {
    "x": {
      "field": "year",
      "type": "quantitative",
      "title": "Year",
      "axis": {
        "grid": true,
        "format": "d",
        "orient": "bottom",
        "tickCount": 10,
        "titleFont": "Baskerville",
        "labelFont": "Baskerville"
      },
      "scale": {"domain": [1997, 2025]}
    },
    "y": {
      "field": "avg_price",
      "type": "quantitative",
      "title": "Average Price (Â£)",
      "axis": {
        "grid": true,
        "format": ".2f",
        "titleFont": "Baskerville",
        "labelFont": "Baskerville"
      },
      "scale": {"zero": false}
    },
    "color": {
      "field": "region_name",
      "type": "nominal",
      "scale": {
        "domain": ["London", "Northern Ireland", "Scotland", "Wales"],
        "range": ["#e74c3c", "#3498db", "#2ecc71", "#f39c12"]
      },
      "title": "Region",
      "legend": {
        "orient": "bottom",
        "direction": "horizontal",
        "titleOrient": "left",
        "titleFont": "Baskerville",
        "labelFont": "Baskerville"
      }
    },
    "opacity": {
      "condition": {"param": "regionSelect", "value": 1},
      "value": 0.2
    },
    "tooltip": [
      {"field": "region_name", "type": "nominal", "title": "Region"},
      {"field": "year", "type": "quantitative", "title": "Year"},
      {"field": "avg_price", "type": "quantitative", "format": ".3f", "title": "Average Price"}
    ]
  },
  "config": {
    "background": "#F5F1E8",
    "view": {"stroke": null},
    "font": "Baskerville",
    "axis": {
      "titleFontSize": 14,
      "labelFontSize": 12,
      "gridColor": "#E5E5E5",
      "titleColor": "#1a1a1a",
      "titleFontWeight": "normal",
      "titleFont": "Baskerville",
      "labelFont": "Baskerville"
    },
    "legend": {
      "titleFontSize": 13,
      "labelFontSize": 12,
      "symbolType": "stroke",
      "symbolStrokeWidth": 3,
      "symbolSize": 200,
      "labelLimit": 150,
      "titleFont": "Baskerville",
      "labelFont": "Baskerville"
    },
    "style": {
      "guide-label": {"font": "Baskerville"},
      "guide-title": {"font": "Baskerville"}
    }
  }
}